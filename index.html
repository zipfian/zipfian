<!DOCTYPE html>

<html lang=en>
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Zipfian</title>

  <meta content="width=device-width" name="viewport">
  <link href="center" rel="up" title="Centering">
  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap" rel="stylesheet">
  <style>
    body { color: black; background: white }
    section {
        position: absolute;
        top: 50%;
        left: 50%;
        margin-right: -50%;
        transform: translate(-50%, -50%);
        font-family: 'Lora', serif;
      }

    #translation{
    	font-size:6vw; 
    	width: 8em; 
    	margin-top:0px; 
    	margin-bottom: 0.5em
    }

  </style>
 </head>

<body>
  <section>
   <h1 id = "language">Zipfian</h1>
   <p id = "translation">Start</p>
   Rank : <span id = "rank">0.00%</span> | Probability : <span id = "probability">0.00%</span>
 </section>


  <script>

	var initialX = null;
	var initialY = null;

	var isDeutche = true
	var dictionary = [
						{ 	
							"Deutche": "frag",
							"English": "Ask"
						},
						{ 	
							"Deutche": "fangen",
							"English": "to catch"
						},
						{ 	
							"Deutche": "euer",
							"English": "your"
						},
						{ 	
							"Deutche": "ausgehen",
							"English": "Out"
						},
						{ 	
							"Deutche": "alte",
							"English": "old"
						}
					]

	// var dictionary = JSON.parse(dictionary);
	var lastIndex = 0;
	var dicLength = dictionary.length;
  	var currentIndex = getRandInteger(0, dicLength)
  	console.log('Length : ' + dictionary.length)
  	console.log('currentIndex : ' + currentIndex)

  	function getTranslation(){

  	}

  	function getRandInteger(min, max) {
	  return Math.floor(Math.random() * (max - min) ) + min;
	}

	function getRandNewWord(){

	}

  	function translate(index){
		let text = document.querySelector('#translation');
		let language = document.querySelector('#language');
		let probability = document.querySelector('#probability');
		let rank = document.querySelector('#rank');

		if(isDeutche){
		    text.innerText = dictionary[index].English;
		    language.innerText = "English";

		    rank.innerText = index;
		    probability.innerText = Math.random().toFixed(2);

		    document.body.style.color = "black";
		    document.body.style.backgroundColor = "white";
		    isDeutche = false;
		} else{
		    text.innerText = dictionary[index].Deutche;
		    language.innerText = "Deutsche";

		    rank.innerText = index;
		    probability.innerText = Math.random().toFixed(2);

		    document.body.style.color = "white";
		    document.body.style.backgroundColor = "black";
		    isDeutche = true;
		}
  	}

	function startTouch(e) {
	    initialX = e.touches[0].clientX;
	    initialY = e.touches[0].clientY;
	};

	function moveTouch(e) {
	    if (initialX === null) {
	        return;
	    }

	    if (initialY === null) {
	        return;
	    }

	    var currentX = e.touches[0].clientX;
	    var currentY = e.touches[0].clientY;

	    var diffX = initialX - currentX;
	    var diffY = initialY - currentY;

	    if (Math.abs(diffX) > Math.abs(diffY)) {
	        // sliding horizontally
	        if (diffX > 0) {
	            // swiped left
	            console.log("swiped left");
	            lastIndex = currentIndex;
		    	currentIndex = getRandInteger(0, dicLength)
		    	isDeutche = false
		    	translate(currentIndex, isDeutche)
	        } else {
	            // swiped right
	            console.log("swiped right");
	            lastIndex = currentIndex;
		    	currentIndex = getRandInteger(0, dicLength)
		    	isDeutche = false
		    	translate(currentIndex, isDeutche)
	        }
	    } else {
	        // sliding vertically
	        if (diffY > 0) {
	            // swiped up
	            console.log("swiped up");
	        } else {
	            // swiped down
	            console.log("swiped down");
	        }
	    }

	    initialX = null;
	    initialY = null;

	    e.preventDefault();
	};

	document.addEventListener("touchstart", startTouch);
	document.addEventListener("touchmove", moveTouch);
	// document.addEventListener("mousewheel", this.mousewheel.bind(this), { passive: false });

    document.addEventListener('mousedown', (e) => {
    	translate(currentIndex, isDeutche)
    });

    document.addEventListener('mouseup', (e) => {
    	translate(currentIndex, isDeutche)
    });

    document.addEventListener('onkeypress', (e) => {
    	// e = e || window.event;
    	console.log('Key Pressed')
    	// if (e.keyCode == '37') {
	    //    currentIndex = lastIndex;
	    // }
	    // else if (e.keyCode == '39') {
	    // 	currentIndex = getRandInteger(0, dicLength)
	    // 	// translate(currentIndex, isDeutche)
	    // }
    	// translate(currentIndex, isDeutche)
    });


    document.addEventListener('dblclick', (e) => {
    	lastIndex = currentIndex;
    	currentIndex = getRandInteger(0, dicLength)
    	isDeutche = false
    	translate(currentIndex, isDeutche)
    });
  </script>
</body>

 </html>
